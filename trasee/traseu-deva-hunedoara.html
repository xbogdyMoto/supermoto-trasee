<script>
  const map = L.map('map').setView([45.85, 22.92], 11);
  const osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
    {maxZoom: 19, attribution: '&copy; OpenStreetMap'}).addTo(map);
  const esriSat = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
    {maxZoom: 19, attribution: 'Tiles Â© Esri'});

  L.control.layers({'OpenStreetMap':osm,'Satelit (Esri)':esriSat},{}).addTo(map);
  L.control.scale().addTo(map);

  const g = new L.GPX('deva-hunedoara.gpx', {
    async: true,
    marker_options: {
      startIconUrl: 'https://unpkg.com/leaflet-gpx@1.7.0/pin-icon-start.png',
      endIconUrl:   'https://unpkg.com/leaflet-gpx@1.7.0/pin-icon-end.png',
      shadowUrl:    'https://unpkg.com/leaflet-gpx@1.7.0/pin-shadow.png'
    },
    polyline_options: {weight:4}
  })
  .on('loaded', (e) => {
    map.fitBounds(e.target.getBounds(), {padding:[20,20]});

    // adauga popup-uri pe start/sosire
    const start = e.target.get_starting_point();
    const end   = e.target.get_ending_point();
    L.marker(start).bindPopup('Start traseu').addTo(map);
    L.marker(end).bindPopup('Sosire').addTo(map);
  })
  .addTo(map);
</script>
